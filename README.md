libps4
=====

> Lbc, posix and sce module library for the ps4, generated by libps4-generator using libps4-std-include, libps4-sce-include and libps4-boilerplate

##Description

The libps4 is a generated (otherwise read-only) repository which can be cloned to build libps4.

This is an initial commit. It provides rouchgly 1300 mostly libc and posix functions and the corresponding headers.

If you are inteerested in contributing to libps4, please see libps4-generator, libps4-std-include, libps4-sce-include and libps4-boilerplate for more.

##Internals, Hints and Warnings

###Global variables
Be aware that global variables need to be manually managed. This makes sense, once you consider that we can't stub (intercept access to) them - and that we are (currently) running in a process which has these variables allocated somewhere in memory. As they are globals though, they are exposed as symbols.

When you use certain functions the compiler may complain that extern varables such as `__isthreaded` are undefined since they are not generated by the library (and must be managed manually). The way to resolve this is to declare all varables as `int` in your source and then try to recompile. The compiler will now note that the types of non int globals are missmatched. Since it will tell you the types, you can now adapt them acordingly. Now your code compiles, but the variables will not be in sync with their global (host process) counterpart values. You will need to resolve the global versions manually, by using sceKernelDlsym to get the address of the variable, and then retrieve the value as needed (before and after any accessing functions).
```C
int __isthreaded;
int *__isthreaded_addr; /*dont use postfix p as it may actually used (not the care with __isthreaded)*/

int64_t _main(void)
{
  int libc = sceKernelLoadStartModule("libSceLibcInternal.sprx", 0, NULL, 0, 0, 0);
  sceKernelDlsym(libc, "__isthreaded", (void **)&__isthreaded_addr);

  /* refresh */
  __isthreaded = *__isthreaded_addr; 
```
This should be addressed further and be suppoorted better by standardized macros asap. At best we may be able to auto-resolve them, but that will probably not be in the nearest of futures. 

#Todo
- Extend readme
